<!DOCTYPE html>
<html lang="{{ store.locale }}" dir="{{ store.locale == 'ar' ? 'rtl' : 'ltr' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} - {{ store.name }}</title>
    
    <!-- Fashion Winter Wonderland Theme Meta -->
    <meta name="theme-color" content="#4A154B">
    <meta name="description" content="{{ store.description }}">
    
    <!-- Google Fonts - Luxury Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Salla Core Assets -->
    {{ salla.css }}
    
    <!-- Fashion Winter Theme CSS -->
    <link rel="stylesheet" href="{{ 'fashion-winter-theme.css' | asset }}">
    
    <!-- Fashion Winter Color Palette CSS Variables -->
    <style>
        :root {
            /* Luxury Fashion Color Palette */
            --fashion-rose-gold: #E8B4B8;
            --fashion-champagne: #F7E7CE;
            --fashion-deep-plum: #4A154B;
            --fashion-pearl-white: #FEFEFE;
            --fashion-soft-grey: #F5F5F7;
            --fashion-charcoal: #2C2C2E;
            --fashion-accent-gold: #D4AF37;
            --fashion-blush-pink: #FFE4E1;
            
            /* Gradients */
            --fashion-gradient-primary: linear-gradient(135deg, var(--fashion-deep-plum) 0%, var(--fashion-rose-gold) 100%);
            --fashion-gradient-luxury: linear-gradient(135deg, var(--fashion-champagne) 0%, var(--fashion-pearl-white) 100%);
            --fashion-gradient-accent: linear-gradient(135deg, var(--fashion-accent-gold) 0%, var(--fashion-rose-gold) 100%);
            
            /* Typography */
            --fashion-font-heading: 'Playfair Display', serif;
            --fashion-font-body: 'Inter', sans-serif;
            
            /* Spacing System */
            --fashion-space-xs: 0.25rem;
            --fashion-space-sm: 0.5rem;
            --fashion-space-md: 1rem;
            --fashion-space-lg: 1.5rem;
            --fashion-space-xl: 2rem;
            --fashion-space-2xl: 3rem;
            --fashion-space-3xl: 4rem;
            
            /* Border Radius */
            --fashion-radius-sm: 6px;
            --fashion-radius-md: 12px;
            --fashion-radius-lg: 18px;
            --fashion-radius-xl: 24px;
            
            /* Shadows */
            --fashion-shadow-soft: 0 2px 8px rgba(74, 21, 75, 0.08);
            --fashion-shadow-medium: 0 4px 16px rgba(74, 21, 75, 0.12);
            --fashion-shadow-strong: 0 8px 32px rgba(74, 21, 75, 0.16);
            --fashion-shadow-luxury: 0 12px 48px rgba(74, 21, 75, 0.20);
            
            /* Transitions */
            --fashion-transition-fast: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --fashion-transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --fashion-transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Theme Settings from Twilight */
            --enable-snow: {{ theme.enable_snow ? 'true' : 'false' }};
            --snow-intensity: {{ theme.snow_intensity | default('subtle') }};
            --fashion-effects: {{ theme.fashion_effects | default('true') }};
            --modal-coverage: {{ theme.modal_coverage | default('90') }}%;
        }
    </style>
</head>

<body class="fashion-winter-theme {{ store.locale == 'ar' ? 'rtl' : 'ltr' }}" 
      data-snow-enabled="{{ theme.enable_snow ? 'true' : 'false' }}"
      data-fashion-effects="{{ theme.fashion_effects ? 'true' : 'false' }}">
    
    <!-- Snow Waterfall Canvas -->
    <canvas id="fashion-snow-canvas" 
            class="fashion-snow-canvas"
            aria-hidden="true"></canvas>
    
    <!-- Luxury Loading Overlay -->
    <div id="fashion-loading-overlay" class="fashion-loading-overlay">
        <div class="fashion-loading-content">
            <div class="fashion-loading-logo">
                {% if store.logo %}
                    <img src="{{ store.logo }}" alt="{{ store.name }}" class="fashion-loading-logo-img">
                {% else %}
                    <h2 class="fashion-loading-logo-text">{{ store.name }}</h2>
                {% endif %}
            </div>
            <div class="fashion-loading-spinner"></div>
            <p class="fashion-loading-text">جاري تحضير تجربة التسوق الفاخرة...</p>
        </div>
    </div>
    
    <!-- Holiday Luxury Ribbon -->
    {% if theme.show_holiday_ribbon %}
        {% include 'components.holiday-luxury-ribbon' %}
    {% endif %}
    
    <!-- Fashion Header -->
    {% include 'components.header.fashion-header' %}
    
    <!-- Main Content -->
    <main id="main-content" class="fashion-main-content">
        {% block content %}{% endblock %}
    </main>
    
    <!-- Fashion Footer -->
    {% include 'components.footer.fashion-footer' %}
    
    <!-- Modal Overlay Container -->
    <div id="fashion-modal-container" class="fashion-modal-container"></div>
    
    <!-- Fashion Theme Scripts -->
    <script src="{{ 'fashion-snow-waterfall.js' | asset }}" defer></script>
    <script src="{{ 'fashion-modal-system.js' | asset }}" defer></script>
    <script src="{{ 'fashion-winter-theme.js' | asset }}" defer></script>
    
    <!-- Salla Core Scripts -->
    {{ salla.js }}
    
    <!-- Fashion Theme Initialization -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Fashion Winter Theme
            if (typeof FashionWinterTheme !== 'undefined') {
                window.fashionTheme = FashionWinterTheme.init({
                    enableSnow: {{ theme.enable_snow ? 'true' : 'false' }},
                    snowIntensity: '{{ theme.snow_intensity | default('subtle') }}',
                    fashionEffects: {{ theme.fashion_effects | default('true') }},
                    modalCoverage: '{{ theme.modal_coverage | default('90') }}%',
                    luxuryAnimations: {{ theme.luxury_animations | default('true') }},
                    colorScheme: '{{ theme.fashion_color_scheme | default('luxury') }}'
                });
            }
            
            // Initialize Snow Waterfall
            if ({{ theme.enable_snow ? 'true' : 'false' }} && typeof FashionSnowWaterfall !== 'undefined') {
                window.fashionSnow = FashionSnowWaterfall.init({
                    canvas: document.getElementById('fashion-snow-canvas'),
                    intensity: '{{ theme.snow_intensity | default('subtle') }}',
                    style: 'waterfall',
                    particleCount: {{ theme.snow_particle_count | default('80') }},
                    elegantMode: true
                });
            }
            
            // Initialize Modal System
            if (typeof FashionModalSystem !== 'undefined') {
                window.fashionModals = FashionModalSystem.init({
                    coverage: '{{ theme.modal_coverage | default('90') }}%',
                    luxuryTransitions: true,
                    closeOnOverlay: true
                });
            }
            
            // Hide loading overlay
            setTimeout(() => {
                const loadingOverlay = document.getElementById('fashion-loading-overlay');
                if (loadingOverlay) {
                    loadingOverlay.classList.add('fashion-loading-overlay--hidden');
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                    }, 500);
                }
            }, 1500);
        });
    </script>
</body>
</html>
